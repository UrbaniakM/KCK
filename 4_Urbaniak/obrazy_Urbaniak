from skimage import data, io, measure, color, feature, filters, exposure
from matplotlib import pyplot as plt
import numpy as np

def detect_edges(image, n):
    subPlt = plt.subplot(7,3,n+1)
    subPlt.axis('off')
    percentileP, percentileK = np.percentile(image,(2,98))
    imageGray = exposure.rescale_intensity(image,in_range=(percentileP,percentileK))
    imageGray = color.rgb2grey(imageGray)
    edges = measure.find_contours(imageGray, level=0.3, fully_connected='low', positive_orientation='high')
    for n, edge in enumerate(edges):
        coords = measure.approximate_polygon(edge, tolerance=5.5)
        subPlt.plot(coords[:, 1], coords[:, 0], linewidth=1)
    #io.imshow(image)

if __name__ == '__main__':

    plt.figure(figsize=(15,15),facecolor='black')
    images = io.ImageCollection('/home/mateusz/KCK/4_Urbaniak/images/*.jpg')


    for n,image in enumerate(images):
        detect_edges(image,n)

    plt.tight_layout()
    plt.savefig('obrazy_Urbaniak.pdf')
